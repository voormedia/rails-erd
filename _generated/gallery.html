<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <title>Rails ERD – Gallery of example diagrams</title>
    <meta http-equiv="imagetoolbar" content="no"/>
    <meta http-equiv="X-UA-Compatible" content="IE=8"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link rel="stylesheet" href="/stylesheets/global.css" type="text/css" media="screen"/>
    <meta name="google-site-verification" content="3xA7_gv9Q1kvkHUr5Jw-a9FY2UTgyLKOsz2Ff7K7yTA" />
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-18632698-1']);
      _gaq.push(['_trackPageview']);
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </head>
  <body class="gallery">
    <div class="header">
      <div class="container">
        <h1 class="clearfix">
          <span class="subtitle">Entity-Relationship Diagrams for Ruby on Rails</span>
          <a href="/">Rails ERD</a>
        </h1>
      </div>
    </div>

<div class="navigation clearfix">
  <div class="container">
    <ul>
      <li><a href="/">Summary</a></li>
      <li><a class="selected" href="/gallery.html">Gallery</a></li>
      <li><a href="/install.html">Install</a></li>
      <li><a href="/customise.html">Customise</a></li>
      <li><a href="/doc/">API Docs</a></li>
      <li><a href="http://github.com/voormedia/rails-erd">Source</a></li>
    </ul>
  </div>
</div>


<div class="summary clearfix">
  <div class="container"></div>
</div>

    <div class="main">
      <div class="container">
<p>
  Browse this page to see some example diagrams.
  Many of them are generated from <strong>actual applications</strong>.
  Want to try for yourself? See the <a href="/install.html">installation instructions</a>.
  If you have a great example diagram of an open source Rails 3 project that
  you wish to share, get in touch!
</p>

<h2><a name="refinery">Refinery CMS</a></h2>
<p>
  <a href="http://refinerycms.com/">Refinery</a> is a content management system
  for medium-sized websites. The model diagram generated by Rails ERD is particularly
  clean and convenient.
</p>
<p><img src="/images/refinery.png" class="erd" alt="Refinery CMS entity-relationship diagram"/></p>

<h2><a name="gemcutter">Gemcutter</a></h2>
<p>
  The Rubygems website is powered by <a href="http://rubygems.org/">Gemcutter</a>.
  This application maintains an overview of all available Ruby libraries that
  are packaged as gems.
</p>
<p><img src="/images/gemcutter.png" class="erd" alt="Gemcutter entity-relationship diagram"/></p>

<h2><a name="spree">Typo</a></h2>
<p>
  Some models rely heavily on single table inheritance. <a href="http://github.com/fdv/typo/wiki">Typo</a>, a
  popular blogging application, uses single table inheritance for many of its
  most important models. To explicitly display all child models and their
  relationships, this diagram was generated with <tt>inheritance=true</tt>.
</p>
<p><img src="/images/typo.png" class="erd" alt="Typo entity-relationship diagram"/></p>

<h2><a name="spree">Spree</a></h2>
<p>
  Slightly larger domain models may be difficult to comprehend, even when drawn
  in a diagram. <a href="http://spreecommerce.com/">Spree</a> is an open-source
  e-commerce application with 60 models. If we hide the attributes,
  the diagram gives a clearer overview of the entities themselves. This diagram
  was generated with <tt>attributes=false</tt>.
</p>
<p><img src="/images/spree.png" class="erd" alt="Spree entity-relationship diagram"/></p>

<h2><a name="notations">Detailed examples</a></h2>
<p>
  Now that we've seen some real entity-relationship diagrams, let's see what
  they're composed of exactly. We start with a single entity. Below is the
  database migration of a table named <tt>photographs</tt>, which could
  contain digital photographs and their metadata.
  Based on this database table, Rails ERD renders the <em>Photograph</em>
  entity with all relevant attributes and their types.
</p>
<table class="combined" cellspacing="0"><tr><td>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Schema</span><span class="o">.</span><span class="n">define</span> <span class="k">do</span>
  <span class="n">create_table</span> <span class="s2">&quot;photographs&quot;</span> <span class="k">do</span> <span class="o">|</span><span class="n">t</span><span class="o">|</span>
    <span class="n">t</span><span class="o">.</span><span class="n">decimal</span>  <span class="ss">:aperture</span>
    <span class="n">t</span><span class="o">.</span><span class="n">binary</span>   <span class="ss">:data</span><span class="p">,</span>        <span class="ss">:null</span> <span class="o">=&gt;</span> <span class="kp">false</span>
    <span class="n">t</span><span class="o">.</span><span class="n">text</span>     <span class="ss">:description</span><span class="p">,</span>                 <span class="ss">:limit</span> <span class="o">=&gt;</span> <span class="mi">512</span>
    <span class="n">t</span><span class="o">.</span><span class="n">string</span>   <span class="ss">:filename</span><span class="p">,</span>    <span class="ss">:null</span> <span class="o">=&gt;</span> <span class="kp">false</span><span class="p">,</span> <span class="ss">:limit</span> <span class="o">=&gt;</span> <span class="mi">64</span>
    <span class="n">t</span><span class="o">.</span><span class="n">boolean</span>  <span class="ss">:flash</span>
    <span class="n">t</span><span class="o">.</span><span class="n">integer</span>  <span class="ss">:iso</span>
    <span class="n">t</span><span class="o">.</span><span class="n">float</span>    <span class="ss">:shutter_speed</span>
    <span class="n">t</span><span class="o">.</span><span class="n">datetime</span> <span class="ss">:taken_at</span><span class="p">,</span>    <span class="ss">:null</span> <span class="o">=&gt;</span> <span class="kp">false</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></div>
</td><td><img src="/images/attributes.png" class="erd" alt="Example of entity with attributes"/></td></tr></table>

<p>
  Now we take a look at the relationships that are possible in a model diagram.
  Consider the following two models, which describe <em>countries</em> and
  their <em>heads of state</em>. They are each associated with
  the other model, so they share a <strong>one-to-one relationship</strong>.
  It is rendered as follows...
</p>
<table class="combined" cellspacing="0"><tr><td>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">class</span> <span class="nc">Country</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="c1"># A country may or may not have a head of state.</span>
  <span class="n">has_one</span> <span class="ss">:head_of_state</span>
<span class="k">end</span>


<span class="k">class</span> <span class="nc">HeadOfState</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="n">belongs_to</span> <span class="ss">:country</span>

  <span class="c1"># A head of state always belongs to a country.</span>
  <span class="n">validates_presence_of</span> <span class="ss">:country</span>
<span class="k">end</span></code></pre></div>
</td><td><img src="/images/one-to-one.png" class="erd" alt="One-to-one relationship example"/></td></tr></table>

<p>
  Here's another example. One <em>galleon</em> (a medieval warship) has many <em>cannons</em>.
  If we model them in a database, they will share a <strong>one-to-many relationship</strong>.
  This <em>cardinality</em> is represented with a single arrow.
</p>
<table class="combined" cellspacing="0"><tr><td>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">class</span> <span class="nc">Galleon</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="c1"># Galleons have up to 36 cannons.</span>
  <span class="n">has_many</span> <span class="ss">:cannons</span>

  <span class="n">validates_length_of</span> <span class="ss">:cannons</span><span class="p">,</span> <span class="ss">:maximum</span> <span class="o">=&gt;</span> <span class="mi">36</span>
<span class="k">end</span>


<span class="k">class</span> <span class="nc">Cannon</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="c1"># A cannon belongs to a galleon.</span>
  <span class="n">belongs_to</span> <span class="ss">:galleon</span>
<span class="k">end</span></code></pre></div>
</td><td><img src="/images/one-to-many.png" class="erd" alt="One-to-many relationship example"/></td></tr></table>

<p>
  When drawing a <strong>many-to-many relationship</strong>, both ends are represented
  by an arrow.
</p>
<table class="combined" cellspacing="0"><tr><td>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># The two models are joined by the join table &#39;films_genres&#39;,</span>
<span class="c1"># with two foreign keys, &#39;film_id&#39; and &#39;genre_id&#39;.</span>

<span class="k">class</span> <span class="nc">Film</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="c1"># A film belongs to one or more genres.</span>
  <span class="n">has_and_belongs_to_many</span> <span class="ss">:genres</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Genre</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="c1"># Each genre may be applicable for one or more films.</span>
  <span class="n">has_and_belongs_to_many</span> <span class="ss">:films</span>
<span class="k">end</span></code></pre></div>
</td><td><img src="/images/many-to-many.png" class="erd" alt="Many-to-many relationship example"/></td></tr></table>

<p>
  <strong>Many-to-many relationships</strong> with a <strong>join model</strong> will be drawn
  together with this third model. The individual relationships are displayed as
  one-to-many relationships. The many-to-many relationship is <em>indirect</em>
  and will be drawn with a dotted line.
</p>
<table class="combined" cellspacing="0"><tr><td>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">class</span> <span class="nc">Wizard</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="n">has_many</span> <span class="ss">:spells</span><span class="p">,</span> <span class="ss">:through</span> <span class="o">=&gt;</span> <span class="ss">:spell_masteries</span>
  <span class="n">has_many</span> <span class="ss">:spell_masteries</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Spell</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="n">has_many</span> <span class="ss">:spell_masteries</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">SpellMastery</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="n">belongs_to</span> <span class="ss">:wizard</span>
  <span class="n">belongs_to</span> <span class="ss">:spell</span>
<span class="k">end</span></code></pre></div>
</td><td><img src="/images/many-to-many-indirect.png" class="erd" alt="Indirect many-to-many relationship example"/></td></tr></table>

<p>
  Rails ERD can also draw <strong>single table inheritance</strong>, often
  referred to as <em>specialization</em>. Specialized entities are displayed
  in grey, because they do not have their own table in the database. An open
  arrow points to their parent entity. Inheritance is not enabled by default,
  set <tt>inheritance=true</tt> to turn it on.
</p>
<table class="combined" cellspacing="0"><tr><td>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">class</span> <span class="nc">Beverage</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Beer</span> <span class="o">&lt;</span> <span class="no">Beverage</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Whisky</span> <span class="o">&lt;</span> <span class="no">Beverage</span>
<span class="k">end</span></code></pre></div>
</td><td><img src="/images/single-inheritance.png" class="erd" alt="Single table inheritance example"/></td></tr></table>

<p>
  A slight variation on specialization is <em>generalization</em>.
  This is achieved when an association is re-used on multiple models, forming
  <strong>polymorphic associations</strong>. The generalized entities are fictional, because
  they are not actual models. They also do not correspond to database tables,
  so they are displayed in grey. Polymorphism is not enabled by default,
  set <tt>polymorphism=true</tt> to turn it on.
</p>

<table class="combined" cellspacing="0"><tr><td>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">class</span> <span class="nc">Barricade</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="c1"># Defensible structures have many soldiers.</span>
  <span class="n">has_many</span> <span class="ss">:soldiers</span><span class="p">,</span> <span class="ss">:as</span> <span class="o">=&gt;</span> <span class="ss">:defensible</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Stronghold</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="c1"># Defensible structures have many soldiers.</span>
  <span class="n">has_many</span> <span class="ss">:soldiers</span><span class="p">,</span> <span class="ss">:as</span> <span class="o">=&gt;</span> <span class="ss">:defensible</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Soldier</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="c1"># Soldiers belong to a defensible structure.</span>
  <span class="n">belongs_to</span> <span class="ss">:defensible</span><span class="p">,</span> <span class="ss">:polymorphic</span> <span class="o">=&gt;</span> <span class="kp">true</span>
<span class="k">end</span></code></pre></div>
</td><td><img src="/images/polymorphic-belongs-to.png" class="erd" alt="Single table inheritance example"/></td></tr></table>

<h2><a name="notations">Alternative notation</a></h2>
<p>
  Rails ERD's standard notation is designed to be simple.
  Relationship <em>cardinalities</em> (one-to-many, many-to-many, etc.) are
  indicated with arrows.
  But sometimes you also want to know whether a relationship is <strong>optional or
  mandatory</strong>. This property of relationships, called <em>participation</em>, can
  be added to a diagram by using an alternative notation; set with <tt>notation=bachman</tt>.
</p>
<p>
  The notation that we use was designed by Charles Bachman in 1992.
  It uses open and closed dots to indicate <em>partial</em> and <em>total</em>
  participation. Here's an example, a model of fruit orchards...
</p>
<p><img src="/images/orchard-bachman.png" class="erd" alt="Orchard entity-relationship diagram"/></p>
<p>
  Notice the use of open and closed dots. An <em>open dot</em> means
  that the relationship to the other entity is <strong>optional</strong>, seen
  from the entity it is next to. A <em>closed dot</em> means that the
  relationship is <strong>mandatory</strong>. These properties are automatically
  determined based on your validators and non-nullable foreign keys.
  Based on the diagram above we can conclude the following...
</p>
<table cellspacing="0">
  <tr>
    <td class="list">
      <ul>
        <li><strong>All</strong> companies have many orchards;
          it is <strong>required</strong> for a company to have orchards (<em>closed dot</em>).</li>
        <li><strong>Some</strong> orchards belong to a company;
          it is <strong>optional</strong> for an orchard to belong to a company (<em>open dot</em>).</li>
      </ul>
    </td>
    <td><img src="/images/orchard-company-orchard-bachman.png" class="erd section" alt="A company has many orchards"/></td>
  </tr>
  <tr>
    <td class="list">
      <ul>
        <li><strong>Some</strong> orchards have one stand;
          it is <strong>optional</strong> for an orchard to have a stand (<em>open dot</em>).</li>
        <li><strong>All</strong> stands belong to an orchard;
          it is <strong>mandatory</strong> for a stand to belong to an orchard (<em>closed dot</em>).</li>
      </ul>
    </td>
    <td><img src="/images/orchard-orchard-stand-bachman.png" class="erd section" alt="An orchard has one stand"/></td>
  </tr>
</table>

      </div>
    </div>

    <div class="footer">
      <div class="container">
        <p>Copyright © 2010-2014 <a href="http://voormedia.com/">Voormedia</a> &nbsp;–&nbsp; Created by Rolf Timmermans</p>
      </div>
    </div>
  </body>
</html>