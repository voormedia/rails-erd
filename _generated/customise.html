<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <title>Rails ERD – Customisation options</title>
    <meta http-equiv="imagetoolbar" content="no"/>
    <meta http-equiv="X-UA-Compatible" content="IE=8"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link rel="stylesheet" href="/rails-erd/stylesheets/global.css" type="text/css" media="screen"/>
    <meta name="google-site-verification" content="3xA7_gv9Q1kvkHUr5Jw-a9FY2UTgyLKOsz2Ff7K7yTA" />
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-18632698-1']);
      _gaq.push(['_trackPageview']);
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </head>
  <body class="customise">
    <div class="header">
      <div class="container">
        <h1 class="clearfix">
          <span class="subtitle">Entity-Relationship Diagrams for Ruby on Rails</span>
          <a href="/rails-erd/">Rails ERD</a>
        </h1>
      </div>
    </div>

<div class="navigation clearfix">
  <div class="container">
    <ul>
      <li><a href="/rails-erd/">Summary</a></li>
      <li><a href="/rails-erd/gallery.html">Gallery</a></li>
      <li><a href="/rails-erd/install.html">Install</a></li>
      <li><a class="selected" href="/rails-erd/customise.html">Customise</a></li>
      <li><a href="/doc/">API Docs</a></li>
      <li><a href="http://github.com/voormedia/rails-erd">Source</a></li>
    </ul>
  </div>
</div>


<div class="summary clearfix">
  <div class="container"></div>
</div>

    <div class="main">
      <div class="container">
<p>
  Rails ERD supports several <strong>customisation options</strong>, all of
  which can be provided on the command line.
  Even if you're completely unhappy with the output, you can still use Rails ERD.
  It has a <strong>powerful API</strong> that you can use to inspect your domain models, or to
  easily generate output in the format of your choice.
</p>

<h2><a name="providing-options">Providing options</a></h2>
All options that are supported by Rails ERD can be provided on the command line.
For example...

<div class="console"><pre><code class="language-console" data-lang="console"><span class="gp">%</span> rake erd <span class="nv">orientation</span><span class="o">=</span>vertical <span class="nv">title</span><span class="o">=</span><span class="s1">&#39;My model diagram&#39;</span></code></pre></div>

Continue to read for an overview of all supported options.

<h2><a name="available-options">Available options</a></h2>

The following output options are available in Rails ERD.
<dl>
  <dt><pre>attributes             &lt;type,...&gt; | false</pre></dt>
  <dd>
    Specifies which attributes to include in the diagram output. This can be any
    combination of the following attribute types:
    <dl>
      <dt><pre>foreign_keys</pre></dt><dd>any foreign key column in use for associations</dd>
      <dt><pre>primary_keys</pre></dt><dd>the primary key column (typically <tt>id</tt>)</dd>
      <dt><pre>timestamps</pre></dt><dd>any of the 'magic' timestamp columns (<tt>created_at/on</tt>, <tt>updated_at/on</tt>)</dd>
      <dt><pre>inheritance</pre></dt><dd>the single table inheritance column (typically <tt>type</tt>)</dd>
      <dt><pre>content</pre></dt><dd>all other columns</dd>
    </dl>
    To hide attributes altogether, set this option to <tt>false</tt>.
    Default value: <tt>content</tt>
  </dd>

  <dt><pre>disconnected           true | false</pre></dt>
  <dd>
    Specifies whether or not to display disconnected entities. An entity is
    disconnected if it has no relationships with any other entity.
    Default value: <tt>true</tt>
  </dd>

  <dt><pre>filename               &lt;string&gt;</pre></dt>
  <dd>
    The file basename of the generated diagram. Together with the file type, this
    will determine the file name of the output. Default value: <tt>ERD</tt>
  </dd>

  <dt><pre>filetype               pdf | dot | ...</pre></dt>
  <dd>
    The file type of the generated diagram. PDF output is strongly recommended,
    other formats may render significantly worse. The available formats depend
    on your installation of Graphviz. If you set the file type to <tt>dot</tt>,
    raw Graphviz instructions are saved in <tt>dot</tt> format. This does not
    require Graphviz to be installed. Default value: <tt>pdf</tt>
  </dd>

  <dt><pre>indirect               true | false</pre></dt>
  <dd>
    Specifies whether or not to display relationships that are indirect.
    Indirect relationships are defined in Active Record by
    <tt>has_many :through</tt> associations. Older versions of Graphviz may
    have trouble drawing diagrams with indirect relationships.
    Default value: <tt>true</tt>
  </dd>

  <dt><pre>inheritance            true | false</pre></dt>
  <dd>
    Specifies whether or not to display inheritance hierarchies. Single table
    inheritance in Rails is usually transparent and uninteresting in an
    entity-relationship diagram. In some cases inheritance is central to the
    domain model, however. For example, subtypes may have their own
    relationships, which would be hidden otherwise. In those cases it makes
    a lot of sense to display all subtypes.
    Default value: <tt>false</tt>
  </dd>

  <dt><pre>notation               simple | bachman</pre></dt>
  <dd>
    The ideal diagram notation may not be the same for everyone. Rails ERD
    defaults to simple arrows to indicate cardinalities. No difference is made
    for optional and mandatory relationships (sometimes referred to as
    <em>participation</em>). This a classic way to draw data structures. It is
    easy to understand, and provides enough information in most cases.<br/>
    If you prefer to see the cardinality as well as the participation, try
    setting this option to <tt>bachman</tt>. This is a more advanced notation,
    devised by Charles Bachman in 1992.<br/>
    For notation examples, browse the <a href="/rails-erd/gallery.html#notations">gallery</a>.
    Default value: <tt>simple</tt>
  </dd>

  <dt><pre>orientation            horizontal | vertical</pre></dt>
  <dd>
    Diagrams display entities in a hierarchical way. The hierarchy
    is defined by the associations on your models. A model that <tt>has_one</tt>
    or <tt>has_many</tt> other models will be higher in the hierarchy.
    This option causes the hierarchy to run either horizontally or vertically.
    Which of the two is most appropriate depends on your models, be sure to
    try both. Default value: <tt>horizontal</tt>
  </dd>

  <dt><pre>polymorphism           true | false</pre></dt>
  <dd>
    Specifies whether or not to display polymorphic hierarchies. Polymorphic
    associations are normally displayed as direct relationships. In some cases
    this may be confusing, because it masks their true nature. Enable this
    option if polymorphic associations play a crucial role in your domain model.
    Enabling this option will also display abstract classes.
    Default value: <tt>false</tt>
  </dd>

  <dt><pre>title                  true | false | &lt;string&gt;</pre></dt>
  <dd>
    By default, a title is displayed at the top of the diagram:
    <tt>&quot;&lt;application&gt; domain model&quot;</tt>. You can change the
    title by setting this option. If set to <tt>false</tt>, no title will be
    displayed at all. Default value: <tt>true</tt>
  </dd>

  <dt><pre>warn                   true | false</pre></dt>
  <dd>
    When set to <tt>false</tt>, no warnings are printed to the command line
    while processing models and drawing the diagram. Default value: <tt>true</tt>
  </dd>

  <dt><pre>only                   &lt;string&gt;</pre></dt>
  <dd>
    Only include specified models. Together with exclude, this will allow to
    filter out models on your diagram. Default value: <tt>nil</tt>. Example:
    <tt>only="Order,Customer,Product"</tt>
  </dd>

  <dt><pre>exclude                &lt;string&gt;</pre></dt>
  <dd>
    Exclude specified models. Together with only, this will allow to filter out
    models on your diagram. Default value: <tt>nil</tt>. Example:
    <tt>exclude="User,Role"</tt>
  </dd>

</dl>

<h2><a name="custum-output">Custom output</a></h2>

<p>
  Rails ERD provides an abstract class that you can use to implement your
  own diagram generation code. The following example generates code that can be
  used with <a href="http://yuml.me/">yUML</a>, an online UML diagram service...
</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="nb">require</span> <span class="s2">&quot;rails_erd/diagram&quot;</span>

<span class="k">class</span> <span class="nc">YumlDiagram</span> <span class="o">&lt;</span> <span class="no">RailsERD</span><span class="o">::</span><span class="no">Diagram</span>
  <span class="n">setup</span> <span class="p">{</span> <span class="vi">@edges</span> <span class="o">=</span> <span class="o">[]</span> <span class="p">}</span>

  <span class="c1"># Invoked once for each relationship</span>
  <span class="n">each_relationship</span> <span class="k">do</span> <span class="o">|</span><span class="n">relationship</span><span class="o">|</span>
    <span class="n">line</span> <span class="o">=</span> <span class="k">if</span> <span class="n">relationship</span><span class="o">.</span><span class="n">indirect?</span> <span class="k">then</span> <span class="s2">&quot;-.-&quot;</span> <span class="k">else</span> <span class="s2">&quot;-&quot;</span> <span class="k">end</span>

    <span class="n">arrow</span> <span class="o">=</span> <span class="k">case</span>
    <span class="k">when</span> <span class="n">relationship</span><span class="o">.</span><span class="n">one_to_one?</span>   <span class="k">then</span> <span class="s2">&quot;1</span><span class="si">#{</span><span class="n">line</span><span class="si">}</span><span class="s2">1&gt;&quot;</span>
    <span class="k">when</span> <span class="n">relationship</span><span class="o">.</span><span class="n">one_to_many?</span>  <span class="k">then</span> <span class="s2">&quot;1</span><span class="si">#{</span><span class="n">line</span><span class="si">}</span><span class="s2">*&gt;&quot;</span>
    <span class="k">when</span> <span class="n">relationship</span><span class="o">.</span><span class="n">many_to_many?</span> <span class="k">then</span> <span class="s2">&quot;*</span><span class="si">#{</span><span class="n">line</span><span class="si">}</span><span class="s2">*&gt;&quot;</span>
    <span class="k">end</span>

    <span class="vi">@edges</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;[</span><span class="si">#{</span><span class="n">relationship</span><span class="o">.</span><span class="n">source</span><span class="si">}</span><span class="s2">] </span><span class="si">#{</span><span class="n">arrow</span><span class="si">}</span><span class="s2"> [</span><span class="si">#{</span><span class="n">relationship</span><span class="o">.</span><span class="n">destination</span><span class="si">}</span><span class="s2">]&quot;</span>
  <span class="k">end</span>

  <span class="c1"># Should save or return the generated diagram</span>
  <span class="n">save</span> <span class="p">{</span> <span class="vi">@edges</span> <span class="o">*</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="p">}</span>
<span class="k">end</span></code></pre></div>

<p>
  Only 14 lines of code! Then, simply call...
</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="no">YumlDiagram</span><span class="o">.</span><span class="n">create</span>
<span class="c1">#=&gt; &quot;[Rubygem] 1-*&gt; [Ownership]</span>
<span class="c1">#    [Rubygem] 1-*&gt; [Subscription]</span>
<span class="c1">#    [Rubygem] 1-*&gt; [Version]</span>
<span class="c1">#    [Rubygem] 1-1&gt; [Linkset]</span>
<span class="c1">#    [Rubygem] 1-*&gt; [Dependency]</span>
<span class="c1">#    [Version] 1-*&gt; [Dependency]</span>
<span class="c1">#    [User] 1-*&gt; [Ownership]</span>
<span class="c1">#    [User] 1-*&gt; [Subscription]</span>
<span class="c1">#    [User] 1-*&gt; [WebHook]&quot;</span></code></pre></div>

<p>
  You can paste the resulting code at <a href="http://yuml.me/">yuml.me</a> to
  generate a diagram. <a href="http://yuml.me/diagram/scruffy/class/%5BRubygem%5D%201-*%3E%20%5BOwnership%5D,%20%5BRubygem%5D%201-*%3E%20%5BSubscription%5D,%20%5BRubygem%5D%201-*%3E%20%5BVersion%5D,%20%5BRubygem%5D%201-1%3E%20%5BLinkset%5D,%20%5BRubygem%5D%201-*%3E%20%5BDependency%5D,%20%5BVersion%5D%201-*%3E%20%5BDependency%5D,%20%5BUser%5D%201-*%3E%20%5BOwnership%5D,%20%5BUser%5D%201-*%3E%20%5BSubscription%5D,%20%5BUser%5D%201-*%3E%20%5BWebHook%5D">Here's an example</a>.
</p>

<h2><a name="api">Domain model API</a></h2>
<p>
  Rails ERD allows you to use its internal API to inspect your domain model.
  We give some examples here, but for a complete and up-to-date reference,
  please see the <a href="/doc">API documentation</a>.
</p>
<p>
  Suppose we have the following domain model...
</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">class</span> <span class="nc">User</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="n">has_many</span> <span class="ss">:posts</span>
  <span class="n">has_many</span> <span class="ss">:comments</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Post</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="n">belongs_to</span> <span class="ss">:user</span>
  <span class="n">has_many</span> <span class="ss">:comments</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Comment</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="n">belongs_to</span> <span class="ss">:user</span>
  <span class="n">belongs_to</span> <span class="ss">:post</span>
<span class="k">end</span></code></pre></div>

<p>
  We can use Rails ERD to discover some attributes of our domain model.
</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="nb">require</span> <span class="s2">&quot;rails_erd/domain&quot;</span>

<span class="c1"># Discover all models that are currently loaded...</span>
<span class="n">domain</span> <span class="o">=</span> <span class="no">RailsERD</span><span class="o">::</span><span class="no">Domain</span><span class="o">.</span><span class="n">generate</span>

<span class="c1"># Which entities do we have? Each entity corresponds to a model.</span>
<span class="n">domain</span><span class="o">.</span><span class="n">entities</span>
<span class="c1">#=&gt; [ #&lt;RailsERD::Domain::Entity @model=Comment&gt;,</span>
<span class="c1">#     #&lt;RailsERD::Domain::Entity @model=Post&gt;,</span>
<span class="c1">#     #&lt;RailsERD::Domain::Entity @model=User&gt; ]</span>

<span class="c1"># Does an entity have relationships with other entities?</span>
<span class="n">domain</span><span class="o">.</span><span class="n">entities</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">connected?</span>
<span class="c1">#=&gt; true</span>

<span class="c1"># Let&#39;s see all relationships...</span>
<span class="n">domain</span><span class="o">.</span><span class="n">relationships</span>
<span class="c1">#=&gt; [ #&lt;RailsERD::Domain::Relationship @source=Post @destination=Comment&gt;,</span>
<span class="c1">#     #&lt;RailsERD::Domain::Relationship @source=User @destination=Comment&gt;,</span>
<span class="c1">#     #&lt;RailsERD::Domain::Relationship @source=User @destination=Post&gt; ]</span>

<span class="c1"># What is the destination entity of the first relationship?</span>
<span class="n">domain</span><span class="o">.</span><span class="n">relationships</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">destination</span>
<span class="c1">#=&gt; Comment</span>

<span class="c1"># Does the relationship run in both directions?</span>
<span class="n">domain</span><span class="o">.</span><span class="n">relationships</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">mutual?</span>
<span class="c1">#=&gt; true</span>

<span class="c1"># Is the relationship a one-to-many relationship?</span>
<span class="n">domain</span><span class="o">.</span><span class="n">relationships</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">one_to_many?</span>
<span class="c1">#=&gt; true</span></code></pre></div>

<p>
  Please note that before the 1.0 release, the API may change subtly between
  minor versions.
</p>

      </div>
    </div>

    <div class="footer">
      <div class="container">
        <p>Copyright © 2010-2014 <a href="http://voormedia.com/">Voormedia</a> &nbsp;–&nbsp; Created by Rolf Timmermans</p>
      </div>
    </div>
  </body>
</html>