---
id: gallery
layout: default
title: Gallery of example diagrams
---
<p>
  Browse this page to see some example diagrams.
  Many of them are generated from <strong>actual applications</strong>.
  Want to try for yourself? See the <a href="/install.html">installation instructions</a>.
  If you have a great example diagram of an open source Rails 3 project that
  you wish to share, get in touch!
</p>

<h2><a name="refinery">Refinery CMS</a></h2>
<p>
  <a href="http://refinerycms.com/">Refinery</a> is a content management system
  for medium-sized websites. The model diagram generated by Rails ERD is particularly
  clean and convenient.
</p>
<p><img src="/images/refinery.png" class="erd" alt="Refinery CMS entity-relationship diagram"/></p>

<h2><a name="gemcutter">Gemcutter</a></h2>
<p>
  The Rubygems website is powered by <a href="http://rubygems.org/">Gemcutter</a>.
  This application maintains an overview of all available Ruby libraries that
  are packaged as gems.
</p>
<p><img src="/images/gemcutter.png" class="erd" alt="Gemcutter entity-relationship diagram"/></p>

<h2><a name="spree">Typo</a></h2>
<p>
  Some models rely heavily on single table inheritance. <a href="http://github.com/fdv/typo/wiki">Typo</a>, a
  popular blogging application, uses single table inheritance for many of its
  most important models. To explicitly display all child models and their
  relationships, this diagram was generated with <tt>inheritance=true</tt>.
</p>
<p><img src="/images/typo.png" class="erd" alt="Typo entity-relationship diagram"/></p>

<h2><a name="spree">Spree</a></h2>
<p>
  Slightly larger domain models may be difficult to comprehend, even when drawn
  in a diagram. <a href="http://spreecommerce.com/">Spree</a> is an open-source
  e-commerce application with 60 models. If we hide the attributes,
  the diagram gives a clearer overview of the entities themselves. This diagram
  was generated with <tt>attributes=false</tt>.
</p>
<p><img src="/images/spree.png" class="erd" alt="Spree entity-relationship diagram"/></p>

<h2><a name="notations">Detailed examples</a></h2>
<p>
  Now that we've seen some real entity-relationship diagrams, let's see what
  they're composed of exactly. We start with a single entity. Below is the
  database migration of a table named <tt>photographs</tt>, which could
  contain digital photographs and their metadata.
  Based on this database table, Rails ERD renders the <em>Photograph</em>
  entity with all relevant attributes and their types.
</p>
<table class="combined" cellspacing="0"><tr><td>
{% highlight ruby %}
ActiveRecord::Schema.define do
  create_table "photographs" do |t|
    t.decimal  :aperture
    t.binary   :data,        :null => false
    t.text     :description,                 :limit => 512
    t.string   :filename,    :null => false, :limit => 64
    t.boolean  :flash
    t.integer  :iso
    t.float    :shutter_speed
    t.datetime :taken_at,    :null => false
  end
end
{% endhighlight %}
</td><td><img src="/images/attributes.png" class="erd" alt="Example of entity with attributes"/></td></tr></table>

<p>
  Now we take a look at the relationships that are possible in a model diagram.
  Consider the following two models, which describe <em>countries</em> and
  their <em>heads of state</em>. They are each associated with
  the other model, so they share a <strong>one-to-one relationship</strong>.
  It is rendered as follows...
</p>
<table class="combined" cellspacing="0"><tr><td>
{% highlight ruby %}
class Country < ActiveRecord::Base
  # A country may or may not have a head of state.
  has_one :head_of_state
end


class HeadOfState < ActiveRecord::Base
  belongs_to :country  

  # A head of state always belongs to a country.
  validates_presence_of :country
end
{% endhighlight %}
</td><td><img src="/images/one-to-one.png" class="erd" alt="One-to-one relationship example"/></td></tr></table>

<p>
  Here's another example. One <em>galleon</em> (a medieval warship) has many <em>cannons</em>.
  If we model them in a database, they will share a <strong>one-to-many relationship</strong>.
  This <em>cardinality</em> is represented with a single arrow.
</p>
<table class="combined" cellspacing="0"><tr><td>
{% highlight ruby %}
class Galleon < ActiveRecord::Base
  # Galleons have up to 36 cannons.
  has_many :cannons

  validates_length_of :cannons, :maximum => 36
end


class Cannon < ActiveRecord::Base
  # A cannon belongs to a galleon.
  belongs_to :galleon
end
{% endhighlight %}
</td><td><img src="/images/one-to-many.png" class="erd" alt="One-to-many relationship example"/></td></tr></table>

<p>
  When drawing a <strong>many-to-many relationship</strong>, both ends are represented
  by an arrow.
</p>
<table class="combined" cellspacing="0"><tr><td>
{% highlight ruby %}
# The two models are joined by the join table 'films_genres', 
# with two foreign keys, 'film_id' and 'genre_id'.

class Film < ActiveRecord::Base
  # A film belongs to one or more genres.
  has_and_belongs_to_many :genres
end

class Genre < ActiveRecord::Base
  # Each genre may be applicable for one or more films.
  has_and_belongs_to_many :films
end
{% endhighlight %}
</td><td><img src="/images/many-to-many.png" class="erd" alt="Many-to-many relationship example"/></td></tr></table>

<p>
  <strong>Many-to-many relationships</strong> with a <strong>join model</strong> will be drawn
  together with this third model. The individual relationships are displayed as
  one-to-many relationships. The many-to-many relationship is <em>indirect</em>
  and will be drawn with a dotted line.
</p>
<table class="combined" cellspacing="0"><tr><td>
{% highlight ruby %}
class Wizard < ActiveRecord::Base
  has_many :spells, :through => :spell_masteries
  has_many :spell_masteries
end

class Spell < ActiveRecord::Base
  has_many :spell_masteries
end

class SpellMastery < ActiveRecord::Base
  belongs_to :wizard
  belongs_to :spell
end
{% endhighlight %}
</td><td><img src="/images/many-to-many-indirect.png" class="erd" alt="Indirect many-to-many relationship example"/></td></tr></table>

<p>
  Rails ERD can also draw <strong>single table inheritance</strong>, often
  referred to as <em>specialization</em>. Specialized entities are displayed
  in grey, because they do not have their own table in the database. An open
  arrow points to their parent entity. Inheritance is not enabled by default,
  set <tt>inheritance=true</tt> to turn it on.
</p>
<table class="combined" cellspacing="0"><tr><td>
{% highlight ruby %}
class Beverage < ActiveRecord::Base
end

class Beer < Beverage
end

class Whisky < Beverage
end
{% endhighlight %}
</td><td><img src="/images/single-inheritance.png" class="erd" alt="Single table inheritance example"/></td></tr></table>

<p>
  A slight variation on specialization is <em>generalization</em>.
  This is achieved when an association is re-used on multiple models, forming
  <strong>polymorphic associations</strong>. The generalized entities are fictional, because
  they are not actual models. They also do not correspond to database tables,
  so they are displayed in grey. Polymorphism is not enabled by default,
  set <tt>polymorphism=true</tt> to turn it on.
</p>

<table class="combined" cellspacing="0"><tr><td>
{% highlight ruby %}
class Barricade < ActiveRecord::Base
  # Defensible structures have many soldiers.
  has_many :soldiers, :as => :defensible
end

class Stronghold < ActiveRecord::Base
  # Defensible structures have many soldiers.
  has_many :soldiers, :as => :defensible
end

class Soldier < ActiveRecord::Base
  # Soldiers belong to a defensible structure.
  belongs_to :defensible, :polymorphic => true
end

{% endhighlight %}
</td><td><img src="/images/polymorphic-belongs-to.png" class="erd" alt="Single table inheritance example"/></td></tr></table>

<h2><a name="notations">Alternative notation</a></h2>
<p>
  Rails ERD's standard notation is designed to be simple.
  Relationship <em>cardinalities</em> (one-to-many, many-to-many, etc.) are
  indicated with arrows.
  But sometimes you also want to know whether a relationship is <strong>optional or
  mandatory</strong>. This property of relationships, called <em>participation</em>, can
  be added to a diagram by using an alternative notation; set with <tt>notation=bachman</tt>.
</p>
<p>
  The notation that we use was designed by Charles Bachman in 1992.
  It uses open and closed dots to indicate <em>partial</em> and <em>total</em>
  participation. Here's an example, a model of fruit orchards...
</p>
<p><img src="/images/orchard-bachman.png" class="erd" alt="Orchard entity-relationship diagram"/></p>
<p>
  Notice the use of open and closed dots. An <em>open dot</em> means
  that the relationship to the other entity is <strong>optional</strong>, seen
  from the entity it is next to. A <em>closed dot</em> means that the
  relationship is <strong>mandatory</strong>. These properties are automatically
  determined based on your validators and non-nullable foreign keys.
  Based on the diagram above we can conclude the following...
</p>
<table cellspacing="0">
  <tr>
    <td class="list">
      <ul>
        <li><strong>All</strong> companies have many orchards;
          it is <strong>required</strong> for a company to have orchards (<em>closed dot</em>).</li>
        <li><strong>Some</strong> orchards belong to a company;
          it is <strong>optional</strong> for an orchard to belong to a company (<em>open dot</em>).</li>
      </ul>
    </td>
    <td><img src="/images/orchard-company-orchard-bachman.png" class="erd section" alt="A company has many orchards"/></td>
  </tr>
  <tr>
    <td class="list">
      <ul>
        <li><strong>Some</strong> orchards have one stand;
          it is <strong>optional</strong> for an orchard to have a stand (<em>open dot</em>).</li>
        <li><strong>All</strong> stands belong to an orchard;
          it is <strong>mandatory</strong> for a stand to belong to an orchard (<em>closed dot</em>).</li>
      </ul>
    </td>
    <td><img src="/images/orchard-orchard-stand-bachman.png" class="erd section" alt="An orchard has one stand"/></td>
  </tr>
</table>
